(function(b){b.widget("ui.spinner",{_create:function(){this.currVal=0;this._draw();this._mousewheel();"always"!==this.options.showButtons&&this.buttons.hide();this._aria()},_draw:function(){var a=this,d=a.options,c=a.element.outerWidth(),e=a.element.width()-d.buttonWidth,k=a.element.css("margin-left"),m=a.element.css("margin-right"),g=a.element.addClass("ui-spinner-input").attr("autocomplete","off").wrap(a._uiSpinnerHtml()).css({"margin-left":"0px","margin-right":"0px",width:e}).bind("keydown.spinner",
function(b){return a._keyDown(b)}).bind("keyup.spinner",function(b){return a._keyUp(b)}).bind("blur.spinner",function(b){"keyboard"==a.source&&a._stop();a._readValue()}).parent().append(a._buttonHtml()).width(c).css({"margin-left":k,"margin-right":m}).hover(function(){},function(){"mouse"==a.source&&a._stop()});!b.support.opacity&&"inline-block"==g.css("display")&&8>b.browser.version&&g.css("display","inline");this.element.attr("id",function(){this.id&&g.attr("id","ui-spinner-"+this.id)});d.disabled&&
this.disable();this.buttons=g.find(".ui-spinner-button").css("width",d.buttonWidth).bind("mousedown",function(h){var c=b(this).hasClass("ui-spinner-up")?1:-1;a._stop();a.source="mouse";a._spin(c,h.shiftKey);a.options.disabled||b(this).addClass("ui-state-active");return!0}).bind("mouseup",function(h){a._stop();a.element.focus();b(this).removeClass("ui-state-active")}).hover(function(){a.options.disabled||b(this).addClass("ui-state-hover")},function(a){b(this).removeClass("ui-state-active ui-state-hover")});
b.browser.msie&&this.buttons.bind("dblclick",function(){b(this).trigger("mousedown").trigger("mouseup")});a.uiSpinner=g},_uiSpinnerHtml:function(){return'<span role="spinbutton" class="ui-spinner ui-widget ui-corner-all '+(this.options.spinnerClass||"")+" ui-spinner-"+this.options.dir+'"></span>'},_buttonHtml:function(){return'<a class="ui-spinner-button ui-spinner-up ui-state-default ui-corner-t'+this.options.dir.substr(-1,1)+'"><span class="ui-icon ui-icon-triangle-1-n">&#9650;</span></a><a class="ui-spinner-button ui-spinner-down ui-state-default ui-corner-b'+
this.options.dir.substr(-1,1)+'"><span class="ui-icon ui-icon-triangle-1-s">&#9660;</span></a>'},_keyDown:function(a){var d=a.keyCode;var c=this.options,e=b.ui.keyCode;if(this.timer)return!1;if(d==e.UP||d==e.DOWN||d==e.PAGE_UP||d==e.PAGE_DOWN||d==e.RIGHT||d==e.LEFT)return a=d==e.PAGE_UP||d==e.PAGE_DOWN||a.shiftKey,d=d==e.UP||d==e.PAGE_UP||d==e.RIGHT?1:-1,this.source="keyboard",this._spin(d,a),!1;if(d!=e.HOME||a.shiftKey||null===c.max){if(d!=e.END||a.shiftKey||null===c.min)return d==e.ENTER?(this._readValue(),
!1):!0;this.value(c.min);return!1}this.value(c.max);return!1},_keyUp:function(a){this._stop()},_spin:function(a,b){var c=this.options;var d=this;this.spinCounter=this.spinCounter||0;this.spinStage=this.spinStage||0;var k=c.increments[this.spinStage];k.count&&this.spinCounter>=k.count&&this.spinStage++;k=c.increments[this.spinStage];c=c.next(this.currVal,k[b?"page":"increment"],a,c.min,c.max,c.step);!1!==c&&(this.timer=setTimeout(function(){d._spin(a,b)},k.delay),this.value(c),this.spinCounter++)},
_stop:function(){this.timer&&(clearTimeout(this.timer),this.source=this.timer=this.spinCounter=this.spinStage=null,this._trigger("stop",null,{value:this.currVal}))},value:function(a,b){if(0==arguments.length)return this.currVal;this.currVal=a;b||this._trigger("change",null,{value:a,spinning:!!this.timer});this.element.val(this._formatted());this._aria()},_readValue:function(){var a=this.options.parse(this.element.val());a!=this._formatted()&&this.value(a)},_formatted:function(){var a=this.options;
return a.format(this.currVal,a.precision,a.radixPoint)},_mousewheel:function(){var a=this;b.fn.mousewheel&&a.options.mouseWheel&&this.element.mousewheel(function(d,c){c=b.browser.opera?-c/Math.abs(c):c;if(!a._start(d))return!1;a._spin((0<c?1:-1)*a._step(),d);a.timeout&&window.clearTimeout(a.timeout);a.timeout=window.setTimeout(function(){a.spinning&&(a._stop(d),a._change(d))},400);d.preventDefault()})},_aria:function(){var a=this.options;this.uiSpinner&&this.uiSpinner.attr("aria-valuemin",a.format(a.min)).attr("aria-valuemax",
a.format(a.max)).attr("aria-valuenow",this._formatted())},destroy:function(){b.fn.mousewheel&&this.element.unmousewheel();this.element.removeClass("ui-spinner-input").removeAttr("disabled").removeAttr("autocomplete").removeData("spinner").unbind(".spinner");if(this.uiSpinner)if(null!=this.uiSpinner.parent()[0])this.uiSpinner.replaceWith(this.element);else return this.element.clone(!0)},enable:function(){this.element.removeAttr("disabled").siblings().removeAttr("disabled").parent().removeClass("ui-spinner-disabled ui-state-disabled");
this.options.disabled=!1},disable:function(){this.element.attr("disabled",!0).siblings().attr("disabled",!0).parent().addClass("ui-spinner-disabled ui-state-disabled");this.options.disabled=!0}});b.extend(b.ui.spinner.prototype,{version:"@VERSION",eventPrefix:"spin",options:{initValue:0,defaultValue:0,precision:0,radixPoint:".",min:null,max:null,dir:"ltr",step:1,showButtons:"always",buttonWidth:16,increments:[{count:2,increment:1,page:10,delay:500},{count:50,increment:1,page:10,delay:50},{count:null,
increment:10,page:50,delay:50}],format:function(a,b,c){return a.toFixed(b).replace(".",c)},parse:function(a){return parseFloat(a)},next:function(a,b,c,e,k,m){return 0<c&&a==k||0>c&&a==e?!1:Math.max(e,Math.min(k,a+b*m*c))}}})})(jQuery);this.JSON||(this.JSON={});
(function(){function b(a){return 10>a?"0"+a:a}function a(a){e.lastIndex=0;return e.test(a)?'"'+a.replace(e,function(a){var b=g[a];return"string"===typeof b?b:"\\u"+("0000"+a.charCodeAt(0).toString(16)).slice(-4)})+'"':'"'+a+'"'}function d(b,c){var e,g=k,l=c[b];l&&"object"===typeof l&&"function"===typeof l.toJSON&&(l=l.toJSON(b));"function"===typeof h&&(l=h.call(c,b,l));switch(typeof l){case "string":return a(l);case "number":return isFinite(l)?String(l):"null";case "boolean":case "null":return String(l);
case "object":if(!l)return"null";k+=m;var n=[];if("[object Array]"===Object.prototype.toString.apply(l)){var f=l.length;for(e=0;e<f;e+=1)n[e]=d(e,l)||"null";var t=0===n.length?"[]":k?"[\n"+k+n.join(",\n"+k)+"\n"+g+"]":"["+n.join(",")+"]";k=g;return t}if(h&&"object"===typeof h)for(f=h.length,e=0;e<f;e+=1){var u=h[e];"string"===typeof u&&(t=d(u,l))&&n.push(a(u)+(k?": ":":")+t)}else for(u in l)Object.hasOwnProperty.call(l,u)&&(t=d(u,l))&&n.push(a(u)+(k?": ":":")+t);t=0===n.length?"{}":k?"{\n"+k+n.join(",\n"+
k)+"\n"+g+"}":"{"+n.join(",")+"}";k=g;return t}}"function"!==typeof Date.prototype.toJSON&&(Date.prototype.toJSON=function(a){return isFinite(this.valueOf())?this.getUTCFullYear()+"-"+b(this.getUTCMonth()+1)+"-"+b(this.getUTCDate())+"T"+b(this.getUTCHours())+":"+b(this.getUTCMinutes())+":"+b(this.getUTCSeconds())+"Z":null},String.prototype.toJSON=Number.prototype.toJSON=Boolean.prototype.toJSON=function(a){return this.valueOf()});var c=/[\u0000\u00ad\u0600-\u0604\u070f\u17b4\u17b5\u200c-\u200f\u2028-\u202f\u2060-\u206f\ufeff\ufff0-\uffff]/g,
e=/[\\"\x00-\x1f\x7f-\x9f\u00ad\u0600-\u0604\u070f\u17b4\u17b5\u200c-\u200f\u2028-\u202f\u2060-\u206f\ufeff\ufff0-\uffff]/g,k,m,g={"\b":"\\b","\t":"\\t","\n":"\\n","\f":"\\f","\r":"\\r",'"':'\\"',"\\":"\\\\"},h;"function"!==typeof JSON.stringify&&(JSON.stringify=function(a,b,c){var e;m=k="";if("number"===typeof c)for(e=0;e<c;e+=1)m+=" ";else"string"===typeof c&&(m=c);if((h=b)&&"function"!==typeof b&&("object"!==typeof b||"number"!==typeof b.length))throw Error("JSON.stringify");return d("",{"":a})});
"function"!==typeof JSON.parse&&(JSON.parse=function(a,b){function h(a,c){var f,e=a[c];if(e&&"object"===typeof e)for(f in e)if(Object.hasOwnProperty.call(e,f)){var d=h(e,f);void 0!==d?e[f]=d:delete e[f]}return b.call(a,c,e)}a=String(a);c.lastIndex=0;c.test(a)&&(a=a.replace(c,function(a){return"\\u"+("0000"+a.charCodeAt(0).toString(16)).slice(-4)}));if(/^[\],:{}\s]*$/.test(a.replace(/\\(?:["\\\/bfnrt]|u[0-9a-fA-F]{4})/g,"@").replace(/"[^"\\\n\r]*"|true|false|null|-?\d+(?:\.\d*)?(?:[eE][+\-]?\d+)?/g,
"]").replace(/(?:^|:|,)(?:\s*\[)+/g,""))){var e=eval("("+a+")");return"function"===typeof b?h({"":e},""):e}throw new SyntaxError("JSON.parse");})})();
(function(b){var a=b.Colour=function(f){if(!(this instanceof a))return new a(f);if(!f)throw"Invalid colour specification";if(f instanceof a)this.hsl=f.hsl,this.rgb=f.rgb;else if(void 0!==f.h&&void 0!==f.s&&void 0!==f.l)this.hsl=f;else if("string"==typeof f){if(this.rgb=g(f)||h(f)||g(a.swatches[f.toLowerCase()]),!this.rgb&&(this.hsl=p(f),!this.hsl))throw"Invalid colour specification";}else void 0!==f.r&&void 0!==f.g&&void 0!==f.b&&(this.rgb=f)};a.prototype={_makeRGB:function(){"undefined"==typeof this.rgb&&
(this.rgb=v(this.hsl))},_makeHSL:function(){"undefined"==typeof this.hsl&&(this.hsl=r(this.rgb))},luma:function(){this._makeRGB();return(.3*this.rgb.r+.59*this.rgb.g+.11*this.rgb.b)/255},red:function(f){this._makeRGB();return"undefined"==typeof f?this.rgb.r:new a({r:parseInt(f,10),g:this.rgb.g,b:this.rgb.b,a:this.rgb.a})},green:function(f){this._makeRGB();return"undefined"==typeof f?this.rgb.g:new a({r:this.rgb.r,g:parseInt(f,10),b:this.rgb.b,a:this.rgb.a})},blue:function(f){this._makeRGB();return"undefined"==
typeof f?this.rgb.b:new a({r:this.rgb.r,g:this.rgb.g,b:parseInt(f,10),a:this.rgb.a})},hue:function(f){this._makeHSL();return"undefined"==typeof f?this.hsl.h:new a({h:parseFloat(f),s:this.hsl.s,l:this.hsl.l,a:this.hsl.a})},saturation:function(f){this._makeHSL();return"undefined"==typeof f?this.hsl.s:new a({h:this.hsl.h,s:parseFloat(f),l:this.hsl.l,a:this.hsl.a})},lightness:function(f){this._makeHSL();return"undefined"==typeof f?this.hsl.l:new a({h:this.hsl.h,s:this.hsl.s,l:parseFloat(f),a:this.hsl.a})},
alpha:function(f){if(0===arguments.length)return(this.hsl||this.rgb).a;f=null===f||void 0===f?void 0:parseFloat(f);return this.hsl?new a({h:this.hsl.h,s:this.hsl.s,l:this.hsl.l,a:f}):new a({r:this.rgb.r,g:this.rgb.g,b:this.rgb.b,a:f})},lighten:function(f){this._makeHSL();return new a({h:this.hsl.h,s:this.hsl.s,l:this.hsl.l+(1-this.hsl.l)*f,a:this.hsl.a})},darken:function(f){this._makeHSL();return new a({h:this.hsl.h,s:this.hsl.s,l:this.hsl.l*(1-f),a:this.hsl.a})},invert:function(){this._makeRGB();
return new a({r:255-this.rgb.r,g:255-this.rgb.g,b:255-this.rgb.b,a:this.rgb.a})},complement:function(){this._makeHSL();return new a({h:(this.hsl.h+.5)%1,s:this.hsl.s,l:this.hsl.l,a:this.hsl.a})},desaturate:function(){this._makeHSL();return new a({h:this.hsl.h,s:0,l:this.hsl.l,a:this.hsl.a})},contrast:function(f,b){return new a(.6<this.luma()?b||"#111":f||"#eee")},analagous:function(){return[this,this.hue(this.hue()-1/12),this.hue(this.hue()+1/12)]},tetrad:function(){return[this,this.hue(this.hue()+
.25),this.hue(this.hue()+.5),this.hue(this.hue()+.75)]},rectTetrad:function(){return[this,this.hue(this.hue()+1/6),this.hue(this.hue()+.5),this.hue(this.hue()+4/6)]},triad:function(){return[this,this.hue(this.hue()-1/3),this.hue(this.hue()+1/3)]},splitComplementary:function(){return[this,this.hue(this.hue()-5/12),this.hue(this.hue()+5/12)]},toString:function(){return this.toHexString()},toHexString:function(){this._makeRGB();return q(this.rgb)},toRGBString:function(){this._makeRGB();return l(this.rgb)},
toHSLString:function(){this._makeHSL();return n(this.hsl)}};var d=function(a){1==a.length&&(a+=a);return Math.max(0,Math.min(255,parseInt(a,16)))};var c=function(a){var b="%"==a.charAt(a.length-1);b&&(a=a.slice(0,a.length-1));return Math.max(0,Math.min(255,Math.round(parseInt(a,10)*(b?2.55:1))))};var e=function(a){return a?Math.max(0,Math.min(1,parseFloat(a))):void 0};var k=function(a){a=parseInt(a,10)%360;0>a&&(a+=360);return a/360};var m=function(a){return Math.max(0,Math.min(100,parseInt(a,10)))/
100};var g=a.hexToRGB=function(a){return(a=/^#([\da-f])([\da-f])([\da-f])([\da-f])?$/i.exec(a)||/^#([\da-f]{2})([\da-f]{2})([\da-f]{2})([\da-f]{2})?$/i.exec(a))?{r:d(a[1]),g:d(a[2]),b:d(a[3]),a:"undefined"==typeof a[4]||""==a[4]?void 0:d(a[4])/255}:void 0};var h=a.cssRGBToRGB=function(a){return(a=/^rgba?\(\s*(-?\d+%?)\s*,\s*(-?\d+%?)\s*,\s*(-?\d+%?)\s*(?:,\s*(-?\d*(?:\.\d+)?)?)?\s*\)$/.exec(a))?{r:c(a[1]),g:c(a[2]),b:c(a[3]),a:e(a[4])}:void 0};var l=a.rgbToCSSRGB=function(a){return"rgb"+(a.a?"a":
"")+"("+Math.round(a.r)+", "+Math.round(a.g)+", "+Math.round(a.b)+(a.a?", "+a.a.toFixed(2):"")+")"};var n=a.hslToCSSHSL=function(a){return"hsl"+(a.a?"a":"")+"("+Math.round(360*a.h)+", "+Math.round(100*a.s)+"%, "+Math.round(100*a.l)+"%"+(a.a?", "+a.a.toFixed(2):"")+")"};var p=a.cssHSLToHSL=function(a){return(a=/^hsla?\(\s*(-?\d+)\s*,\s*(-?\d+%)\s*,\s*(-?\d+%)\s*(?:,\s*(-?\d*(?:\.\d+)?)?)?\s*\)$/.exec(a))?{h:k(a[1]),s:m(a[2]),l:m(a[3]),a:e(a[4])}:void 0};var q=a.rgbToHex=function(a){var b="#"+(16>a.r?
"0":"")+a.r.toString(16)+(16>a.g?"0":"")+a.g.toString(16)+(16>a.b?"0":"")+a.b.toString(16);void 0!==a.a&&(a=Math.floor(255*a.a),b+=(16>a?"0":"")+a.toString(16));return b};var r=a.rgbToHSL=function(a){var b,c,h=a.r/255,e=a.g/255,d=a.b/255,f=c=0;var l=Math.max(h,e,d);var g=Math.min(h,e,d);var k=(g+l)/2;if(0<k&&(f=b=l-g,0<f)){f/=.5>=k?l+g:2-l-g;c=(l-h)/b;var n=(l-e)/b;b=(l-d)/b;c=(h==l?e==g?5+b:1-n:e==l?d==g?1+c:3-b:h==g?3+n:5-c)/6}return{h:c%1,s:f,l:k,a:a.a}};var v=a.hslToRGB=function(a){var b,c;var h=
a.h%1;var e=a.s;var d=a.l;0>h&&(h+=1);var f=b=c=d;e=.5>=d?d*(1+e):d+e-d*e;if(0<e){d=d+d-e;h*=6;var l=Math.floor(h);var g=(e-d)/e*e*(h-l);h=d+g;g=e-g;switch(l){case 0:f=e;b=h;c=d;break;case 1:f=g;b=e;c=d;break;case 2:f=d;b=e;c=h;break;case 3:f=d;b=g;c=e;break;case 4:f=h;b=d;c=e;break;case 5:f=e,b=d,c=g}}return{r:Math.floor(255*f),g:Math.floor(255*b),b:Math.floor(255*c),a:a.a}};a.swatches={aliceblue:"#f0f8ff",antiquewhite:"#faebd7",aqua:"#00ffff",aquamarine:"#7fffd4",azure:"#f0ffff",beige:"#f5f5dc",
bisque:"#ffe4c4",black:"#000000",blanchedalmond:"#ffebcd",blue:"#0000ff",blueviolet:"#8a2be2",brown:"#a52a2a",burlywood:"#deb887",cadetblue:"#5f9ea0",chartreuse:"#7fff00",chocolate:"#d2691e",coral:"#ff7f50",cornflowerblue:"#6495ed",cornsilk:"#fff8dc",crimson:"#dc143c",cyan:"#00ffff",darkblue:"#00008b",darkcyan:"#008b8b",darkgoldenrod:"#b8860b",darkgray:"#a9a9a9",darkgreen:"#006400",darkgrey:"#a9a9a9",darkkhaki:"#bdb76b",darkmagenta:"#8b008b",darkolivegreen:"#556b2f",darkorange:"#ff8c00",darkorchid:"#9932cc",
darkred:"#8b0000",darksalmon:"#e9967a",darkseagreen:"#8fbc8f",darkslateblue:"#483d8b",darkslategray:"#2f4f4f",darkslategrey:"#2f4f4f",darkturquoise:"#00ced1",darkviolet:"#9400d3",deeppink:"#ff1493",deepskyblue:"#00bfff",dimgray:"#696969",dimgrey:"#696969",dodgerblue:"#1e90ff",firebrick:"#b22222",floralwhite:"#fffaf0",forestgreen:"#228b22",fuchsia:"#ff00ff",gainsboro:"#dcdcdc",ghostwhite:"#f8f8ff",gold:"#ffd700",goldenrod:"#daa520",gray:"#808080",green:"#008000",greenyellow:"#adff2f",grey:"#808080",
honeydew:"#f0fff0",hotpink:"#ff69b4",indianred:"#cd5c5c",indigo:"#4b0082",ivory:"#fffff0",khaki:"#f0e68c",lavender:"#e6e6fa",lavenderblush:"#fff0f5",lawngreen:"#7cfc00",lemonchiffon:"#fffacd",lightblue:"#add8e6",lightcoral:"#f08080",lightcyan:"#e0ffff",lightgoldenrodyellow:"#fafad2",lightgray:"#d3d3d3",lightgreen:"#90ee90",lightgrey:"#d3d3d3",lightpink:"#ffb6c1",lightsalmon:"#ffa07a",lightseagreen:"#20b2aa",lightskyblue:"#87cefa",lightslategray:"#778899",lightslategrey:"#778899",lightsteelblue:"#b0c4de",
lightyellow:"#ffffe0",lime:"#00ff00",limegreen:"#32cd32",linen:"#faf0e6",magenta:"#ff00ff",maroon:"#800000",mediumaquamarine:"#66cdaa",mediumblue:"#0000cd",mediumorchid:"#ba55d3",mediumpurple:"#9370db",mediumseagreen:"#3cb371",mediumslateblue:"#7b68ee",mediumspringgreen:"#00fa9a",mediumturquoise:"#48d1cc",mediumvioletred:"#c71585",midnightblue:"#191970",mintcream:"#f5fffa",mistyrose:"#ffe4e1",moccasin:"#ffe4b5",navajowhite:"#ffdead",navy:"#000080",oldlace:"#fdf5e6",olive:"#808000",olivedrab:"#6b8e23",
orange:"#ffa500",orangered:"#ff4500",orchid:"#da70d6",palegoldenrod:"#eee8aa",palegreen:"#98fb98",paleturquoise:"#afeeee",palevioletred:"#db7093",papayawhip:"#ffefd5",peachpuff:"#ffdab9",peru:"#cd853f",pink:"#ffc0cb",plum:"#dda0dd",powderblue:"#b0e0e6",purple:"#800080",red:"#ff0000",rosybrown:"#bc8f8f",royalblue:"#4169e1",saddlebrown:"#8b4513",salmon:"#fa8072",sandybrown:"#f4a460",seagreen:"#2e8b57",seashell:"#fff5ee",sienna:"#a0522d",silver:"#c0c0c0",skyblue:"#87ceeb",slateblue:"#6a5acd",slategray:"#708090",
slategrey:"#708090",snow:"#fffafa",springgreen:"#00ff7f",steelblue:"#4682b4",tan:"#d2b48c",teal:"#008080",thistle:"#d8bfd8",tomato:"#ff6347",turquoise:"#40e0d0",violet:"#ee82ee",wheat:"#f5deb3",white:"#ffffff",whitesmoke:"#f5f5f5",yellow:"#ffff00",yellowgreen:"#9acd32"}})(this);
(function(b){b.widget("ui.colourComponent",{_create:function(){var a=this;this.element.addClass("colour-component");a.queuedUpdate=null;this.sliderDiv=b("<span/>").addClass("colour-component-slider").appendTo(this.element);this.slider=this.sliderDiv.slider({min:0,max:this.options.scale,step:this.options.step,slide:function(b,c){a.options.colourProxy.set(a.options.colourProxy[a.options.component](c.value),!0)},stop:function(b,c){a.options.colourProxy.set(a.options.colourProxy[a.options.component](c.value))}}).data("slider");
this.canvas=b("<canvas/>").addClass("ui-corner-all").attr({width:255,height:20}).appendTo(this.sliderDiv);this._acquireCtx();this.handle=this.sliderDiv.find(".ui-slider-handle").append("<img src='thumb.png' class='colour-component-grippy'>");this.input=b("<input/>").appendTo(this.element);this.input.spinner({min:0,max:this.options.scale,step:this.options.step,precision:this.options.places,change:function(b,c){a.options.colourProxy.set(a.options.colourProxy[a.options.component](a.input.spinner("value")),
c.spinning)},stop:function(b,c){a.options.colourProxy.set(a.options.colourProxy[a.options.component](a.input.spinner("value")))}});this.leftHeader=b("<h4/>").addClass("slider-label").html(this.options.title).appendTo(this.sliderDiv);this.rightHeader=b("<div/>").addClass("slider-label").addClass("slider-label-secondary").html(this.options.title).appendTo(this.sliderDiv).hide();this.shownHeader="left";this.options.colourProxy.change(function(b){a.update(b)})},_acquireCtx:function(){function a(){try{b.ctx=
b.canvas[0].getContext("2d"),b.queuedUpdate&&b.update(b.queuedUpdate)}catch(e){8>c&&("undefined"!=typeof G_vmlCanvasManager&&G_vmlCanvasManager.initElement(b.canvas.get(0)),setTimeout(a,50*(Math.pow(2,c)-1)),c++)}}var b=this,c=0;a()},update:function(a){var b=a[this.options.component]();this.slider.value(b);if(this.ctx){a=this.options.getGradient(a);var c=this.ctx.createLinearGradient(0,0,255,0);for(i=0;i<a.length;i++)try{c.addColorStop(1/(a.length-1)*i,a[i].toString())}catch(e){return}this.ctx.fillStyle=
c;this.ctx.fillRect(0,0,256,20);c=a[0].contrast().toString();a=a.slice(-1)[0].contrast().toString();this.leftHeader.css("color",c);this.rightHeader.css("color",a)}else this.queuedUpdate=a;this.input.spinner("value",b,!0);b=this.handle.position().left;120<b&&"right"==this.shownHeader&&(this.rightHeader.stop(!1,!0).hide(),this.leftHeader.stop(!1,!0).show(),this.shownHeader="left");120>b&&"left"==this.shownHeader&&(this.rightHeader.stop(!1,!0).show(),this.leftHeader.stop(!1,!0).hide(),this.shownHeader=
"right")}});b.ui.colourComponent.prototype.options={scale:255,step:1,places:0};b.widget("ui.colourComponentRGB",b.ui.colourComponent.prototype);b.ui.colourComponentRGB.prototype.options={scale:255,step:1,places:0};b.widget("ui.colourComponentHSL",b.ui.colourComponent.prototype);b.ui.colourComponentHSL.prototype.options={scale:1,step:.01,places:2};b.widget("ui.colourSwatch",{_create:function(){var a=this;this.element.addClass("colour-swatch ui-corner-all");this.swatch=b("<div/>").addClass("colour-swatch-inner ui-corner-all").appendTo(this.element);
this.readout=b("<span class='colour-swatch-readout'/>").click(function(){return!1}).appendTo(this.element);this.options.colourProxy&&this.options.colourProxy.change(function(b){a.update(b)});this.element.click(function(b){a.options.click.call(a.options,b,{element:a.element,swatch:a.swatch})})},update:function(a){this.options.colour=this.options.makeColour(a);this.swatch.css({"background-color":this.options.colour.toString()});this.readout.html(this.options.colour.toString())}});b.ui.colourSwatch.prototype.options=
{colour:new Colour("black"),makeColour:function(a){return a},click:function(){this.colourProxy&&this.colourProxy.set(this.colour)}};b.widget("ui.colourSwatchGroup",{_create:function(){var a=this;this.swatches=[];b("<h2/>").html(this.options.title).appendTo(this.element);this.options.colourProxy.change(function(b){a.update(b)});this.element.addClass("colour-swatch-group")},update:function(a,d){var c=this;if(d||this.element.is(":visible")){for(this.colours=this.options.makeColours(a);this.swatches.length<
this.colours.length;)this.swatches.push(b("<span/>").colourSwatch({click:function(){c.options.colourProxy.set(this.colour)}}).appendTo(c.element).data("colourSwatch"));for(;this.swatches.length>this.colours.length;)this.swatches.pop().element.remove();b.each(this.swatches,function(a,b){b.update(c.colours[a])})}}});b.ui.colourSwatchGroup.prototype.options={title:""}})(jQuery);
(function(b){function a(a){var b,c=this;this.colour=new Colour(a||"#000");this.updateQueued=!1;this.changeCallbacks=[];this.historyCallbacks=[];this.historyList=[];for(b in Colour.prototype)"[object Function]"===Object.prototype.toString.call(Colour.prototype[b])&&function(a){c[a]=function(){return c.colour[a].apply(c.colour,arguments)}}(b)}function d(a,b){this._cookieName=a||"settings";this._days=b||100;try{this._settings=JSON.parse(this._readCookie())}catch(k){}this._settings=this._settings||{}}
a.prototype={set:function(a,b){b?this.histColour||(this.histColour=this.colour):(this.historyList.push(this.histColour||this.colour),this.histColour=null,this._history(a));this.colour=a;this._change()},getColour:function(){return this.colour},change:function(a){a?this.changeCallbacks.push(a):this._change()},_change:function(){var a,b=this;this.updateQueued||(setTimeout(function(){b.updateQueued=!1;for(a=0;a<b.changeCallbacks.length;a++)b.changeCallbacks[a].call(b.colour,b.colour)},0),this.updateQueued=
!0)},history:function(a){a?this.historyCallbacks.push(a):this._history()},_history:function(a){var b;for(b=0;b<this.historyCallbacks.length;b++)this.historyCallbacks[b].call(this.historyList,this.historyList,a)},toString:function(){return this.colour.toString()}};d.prototype={get:function(a,b){return this._settings[a]||b||null},set:function(a,b){this._settings[a]=b;this._createCookie(JSON.stringify(this._settings),365)},destroy:function(){this._eraseCookie();this._settings={}},_createCookie:function(a){var b=
new Date;b.setTime(b.getTime()+864E5*this._days);b="; expires="+b.toGMTString();document.cookie=this._cookieName+"="+a+b+"; path=/"},_readCookie:function(a){a=this._cookieName+"=";for(var b=document.cookie.split(";"),c=0;c<b.length;c++){for(var d=b[c];" "==d.charAt(0);)d=d.substring(1,d.length);if(0==d.indexOf(a))return d.substring(a.length,d.length)}return null},_eraseCookie:function(){createCookie(this._cookieName,"",-1)}};b.ColourProxy=a;b.Settings=d})(this);
(function(b,a){function d(a){var h=window.location.toString().replace(/#[^#]*$/,"");var c=[a.toHexString().substring(1)];a=m.get("palette");null!==a&&(a=a.split(","),b.each(a,function(a,b){c.push(b.substring(1))}));h=[h,"#",c.join("-")].join("");b("#share-url").attr("value",h);window.location=h}function c(){return b.map(window.location.toString().replace(/^[^#]+(#|$)/,"").split("-"),function(a,b){return a.length?new Colour("#"+a):null})}function e(a,b,c){if(c){var h=new Date;h.setTime(h.getTime()+
864E5*c);c="; expires="+h.toGMTString()}else c="";document.cookie=a+"="+b+c+"; path=/"}function k(a){a+="=";for(var b=document.cookie.split(";"),h=0;h<b.length;h++){for(var c=b[h];" "==c.charAt(0);)c=c.substring(1,c.length);if(0==c.indexOf(a))return c.substring(a.length,c.length)}return null}var m=new Settings,g;b(function(){function a(a){b("html").removeClass("light-theme dark-theme").addClass(a);m.set("theme",a)}var c=b("[name=theme]"),d=m.get("theme","dark-theme");"light-theme"==d?b("#select-light").attr("checked",
"checked"):b("#select-dark").attr("checked","checked");b("#theme-select").buttonset({text:!0});c.change(function(b){a(b.target.value)});a(d)});b(function(){var a,c=b("#main-swatch"),n=b("#main-readout"),p=b("#history");updateQueued=!1;histList=(histCookie=k("colour-history"))?histCookie.split(","):[];g=new ColourProxy(m.get("current-colour","hotpink"));n.change(function(){try{g.set((new Colour(n.val())).alpha(null))}catch(r){try{g.set((new Colour("#"+n.val())).alpha(null))}catch(v){}}});g.history(function(a){b("<div/>").addClass("colour-history-swatch ui-corner-all").css({"background-color":a.slice(-1)[0].toString()}).prependTo(p).hide().slideDown();
p.children(":gte(250)").remove()});g.history(function(a,c){e("colour-history",b.map(a,function(a){return a.toString()}).slice(-250).join(","),365);d(c)});p.delegate(".colour-history-swatch","click",function(a){g.set(Colour(b(a.target).css("background-color")))});var q=[];g.historyList=b.map(histList,function(a){return Colour(a)});for(a=histList.length;a--;)q.push("<div class='colour-history-swatch ui-corner-all' style='background-color: ",histList[a],";'/>");p.append(q.join(""));g.change(function(){c.css({"background-color":g.toString(),
color:g.contrast()});n.css({"border-color":g.contrast().toString(),background:g.toString()+" none",color:g.contrast().toString()}).val(g.toString());m.set("current-colour",g.toString())})});b(function(){rSlider=b("#r-slider").colourComponentRGB({title:"Red",component:"red",getGradient:function(a){return[a.red(0),a.red(255)]},colourProxy:g}).data("colourComponentRGB");gSlider=b("#g-slider").colourComponentRGB({title:"Green",component:"green",getGradient:function(a){return[a.green(0),a.green(255)]},
colourProxy:g}).data("colourComponentRGB");bSlider=b("#b-slider").colourComponentRGB({title:"Blue",component:"blue",getGradient:function(a){return[a.blue(0),a.blue(255)]},colourProxy:g}).data("colourComponentRGB");hSlider=b("#h-slider").colourComponentHSL({title:"Hue",component:"hue",getGradient:function(a){return[a.hue(0),a.hue(1/6),a.hue(1/3),a.hue(.5),a.hue(2/3),a.hue(5/6),a.hue(0)]},colourProxy:g}).data("colourComponentHSL");sSlider=b("#s-slider").colourComponentHSL({title:"Saturation",component:"saturation",
getGradient:function(a){return[a.saturation(0),a.saturation(1)]},colourProxy:g}).data("colourComponentHSL");lSlider=b("#l-slider").colourComponentHSL({title:"Lightness",component:"lightness",getGradient:function(a){return[a.lightness(0),a.lightness(.5),a.lightness(1)]},colourProxy:g}).data("colourComponentHSL");variants=b("#swatch-variants").colourSwatchGroup({makeColours:function(a){return[a,a.invert(),a.complement(),a.desaturate()]},colourProxy:g}).data("colourSwatch");analagous=b("#swatch-analagous").colourSwatchGroup({makeColours:function(a){return a.analagous()},
colourProxy:g}).data("colourSwatchGroup");tetrad=b("#swatch-tetrad").colourSwatchGroup({makeColours:function(a){return a.tetrad()},colourProxy:g}).data("colourSwatchGroup");rectTerad=b("#swatch-rect-tetrad").colourSwatchGroup({makeColours:function(a){return a.rectTetrad()},colourProxy:g}).data("colourSwatchGroup");triad=b("#swatch-triad").colourSwatchGroup({makeColours:function(a){return a.triad()},colourProxy:g}).data("colourSwatchGroup");split=b("#swatch-split").colourSwatchGroup({makeColours:function(a){return a.splitComplementary()},
colourProxy:g}).data("colourSwatchGroup");shades=b("#swatch-shades").colourSwatchGroup({makeColours:function(a){return[a.darken(.5),a.darken(.25),a,a.lighten(.25),a.lighten(.5)]},colourProxy:g}).data("colourSwatchGroup");g.change()});b(function(){var a,c=m.get("accordion");c=c?b(c).prev():0;b("#swatches").accordion({header:"> h3",autoHeight:!1,fillSpace:!0,active:c,changestart:function(a,b){b.newContent.colourSwatchGroup("update",g,!0);m.set("accordion","#"+b.newContent.attr("id"))}});b(window).bind("resize",
function(c){a&&clearTimeout(a);a=setTimeout(function(){b("#swatches").accordion("resize");a=null},50)})});b(function(){function a(){var a=[];b("#palette-bag .colour-swatch").each(function(){a.push(b(this).colourSwatch("option","colour").toString())});m.set("palette",a.join(","));d(g)}function e(){0===b("#palette-bag .ui-selected").length?b("#delete-colour").button("disable"):b("#delete-colour").button("enable")}function k(c,d){b("<span/>").colourSwatch({click:function(a,c){g.set(this.colour);a.ctrlKey||
a.shiftKey?c.element.toggleClass("ui-selected"):(b("#palette-bag .ui-selected").removeClass("ui-selected"),c.element.addClass("ui-selected"));e()}}).colourSwatch("update",c).css("opacity",0).prependTo(v).animate({opacity:1});d||a()}var p,q=m.get("palette"),r=c(),v=b("#palette-bag");if(r&&0<r.length){g.set(r[0],!0);for(p=r.length;1<p--;)k(r[p],!0);a()}else if(q)for(q=q.split(","),p=q.length;p--;)k(new Colour(q[p]),!0);b("#save-colour").button({icons:{primary:"ui-icon-disk"}}).click(function(){k(g.getColour())});
b("#palette-bag").sortable({forcePlaceholderSize:!0,scroll:!1,tolerance:"pointer",stop:a}).selectable({filter:".colour-swatch",unselected:e,selected:e});b("#delete-colour").button({disabled:!0,icons:{primary:"ui-icon-trash"}}).click(function(){b("#palette-bag .ui-selected").remove();a();e()})});b(function(){b("#help-frame").dialog({width:600,height:450,autoOpen:!1,title:"Colour Toy Help",autoResize:!0});b("#share-frame").dialog({width:600,height:130,autoOpen:!1,title:"Save & share"});b("#save-button").button({icons:{primary:"ui-icon-star"}}).click(function(a){b("#share-frame").dialog("open")});
b("#help-button").button({icons:{primary:"ui-icon-info"}}).click(function(a){b("#help-frame").attr("src","http://docs.google.com/View?id=dc4kk99z_56c7zkfhdx").dialog("open").width(590).height(440)})});b(function(){var a=!1;b("#disqus_thread").dialog({width:600,height:450,autoOpen:!1,title:"Comment on The Colour Toy"});b("#discuss-button").button({icons:{primary:"ui-icon-person"}}).click(function(c){a||(c=document.createElement("script"),c.type="text/javascript",c.async=!0,c.src="http://colourtoy.disqus.com/embed.js",
(document.getElementsByTagName("head")[0]||document.getElementsByTagName("body")[0]).appendChild(c),a=!0);b("#disqus_thread").dialog("open")})})})(jQuery,this);
